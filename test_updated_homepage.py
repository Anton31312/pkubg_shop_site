#!/usr/bin/env python
"""
–¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –Ω–æ–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º.
"""
import requests
import json

BASE_URL = 'http://127.0.0.1:8000/api'

def test_updated_homepage():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É."""
    
    print("üé® –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã...")
    
    # –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–∞
    print("\n1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–∞ (10 –Ω–∞ —Å–ª–∞–π–¥–µ)...")
    try:
        response = requests.get(f'{BASE_URL}/products/categories/')
        response.raise_for_status()
        data = response.json()
        
        categories_count = data.get('count', len(data) if isinstance(data, list) else 0)
        slides_needed = (categories_count + 9) // 10  # –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö
        
        print(f"   ‚úÖ –í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {categories_count}")
        print(f"   ‚úÖ –°–ª–∞–π–¥–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è: {slides_needed}")
        print(f"   ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–ª–∞–π–¥–µ: {categories_count % 10 or 10}")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        if data.get('results'):
            print("   üìã –ü–µ—Ä–≤—ã–µ 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞:")
            for i, category in enumerate(data['results'][:10], 1):
                print(f"      {i}. {category['name']}")
        
    except Exception as e:
        print(f"   ‚ùå –û—à–∏–±–∫–∞: {e}")
        return
    
    # –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–µ–π –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    print("\n2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–µ–π –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã...")
    try:
        response = requests.get(f'{BASE_URL}/articles/api/articles/', params={'page_size': 3})
        response.raise_for_status()
        data = response.json()
        
        articles_count = data.get('count', len(data) if isinstance(data, list) else 0)
        print(f"   ‚úÖ –í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π: {articles_count}")
        print(f"   ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π: {min(3, articles_count)}")
        
        if data.get('results'):
            print("   üì∞ –°—Ç–∞—Ç—å–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ:")
            for i, article in enumerate(data['results'][:3], 1):
                print(f"      {i}. {article['title']}")
                print(f"         –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {article.get('category_name', '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏')}")
                print(f"         –ê–≤—Ç–æ—Ä: {article['author_name']}")
        
    except Exception as e:
        print(f"   ‚ùå –û—à–∏–±–∫–∞: {e}")
    
    # –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã (—Å–∏–º—É–ª—è—Ü–∏—è)
    print("\n3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã...")
    print("   üé® –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:")
    print("      ‚Ä¢ –û—Å–Ω–æ–≤–Ω–æ–π –∑–µ–ª–µ–Ω—ã–π: #2c5530")
    print("      ‚Ä¢ –¢–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π: #1e3a21") 
    print("      ‚Ä¢ –°–µ—Ä—ã–µ —Ç–æ–Ω–∞: #495057, #6c757d")
    print("      ‚Ä¢ –°–≤–µ—Ç–ª—ã–µ —Ç–æ–Ω–∞: #f8f9fa, #e9ecef")
    print("   ‚úÖ –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç header/footer")
    
    # –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–ª–∞–π–¥–µ—Ä–∞
    print("\n4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–ª–∞–π–¥–µ—Ä–∞...")
    print("   üìê –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–∞–π–¥–µ—Ä–∞:")
    print("      ‚Ä¢ 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –æ–¥–Ω–æ–º —Å–ª–∞–π–¥–µ")
    print("      ‚Ä¢ –°–µ—Ç–∫–∞ 5x2 –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ")
    print("      ‚Ä¢ –°–µ—Ç–∫–∞ 2x5 –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ") 
    print("      ‚Ä¢ –°–µ—Ç–∫–∞ 1x10 –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º")
    print("      ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥")
    print("   ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
    
    print("\nüéâ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print("\nüìã –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:")
    print("   ‚úÖ –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞")
    print("   ‚úÖ –°–ª–∞–π–¥–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ —Å–ª–∞–π–¥–µ")
    print("   ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
    print("   ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é –ø–∞–ª–∏—Ç—Ä—É")
    print("\nüåê –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç: http://localhost:3000/")

if __name__ == '__main__':
    test_updated_homepage()